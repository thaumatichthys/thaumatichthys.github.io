import numpy as np
import tensorflow as tf
from PIL import Image
import matplotlib.pyplot as plt

DATASET_PATH = "full-dataset-path"

drawn = Image.open("input.png")  # can use your own input. Should be 64x64, black and white.
input_image = drawn
input_image = input_image.convert("L")
input_image = np.array(input_image)

image_tensor = tf.convert_to_tensor(input_image, dtype=tf.int8)
image_tensor = tf.math.add(image_tensor, -128)
image_tensor = tf.expand_dims(image_tensor, axis=0)
image_tensor = tf.expand_dims(image_tensor, axis=3)

# there is undoubtedly a better way to store this than just slapping it into the script, but whatever ig
names = ['u4e00', 'u4e01', 'u4e03', 'u4e07', 'u4e08', 'u4e09', 'u4e0a', 'u4e0b', 'u4e0d', 'u4e0e', 'u4e11', 'u4e16',
         'u4e18', 'u4e21', 'u4e26', 'u4e2d', 'u4e32', 'u4e38', 'u4e39', 'u4e3b', 'u4e3c', 'u4e43', 'u4e45', 'u4e4b',
         'u4e4f', 'u4e57', 'u4e59', 'u4e5d', 'u4e5e', 'u4e5f', 'u4e71', 'u4e73', 'u4e7e', 'u4e80', 'u4e86', 'u4e88',
         'u4e89', 'u4e8b', 'u4e8c', 'u4e92', 'u4e94', 'u4e95', 'u4e98', 'u4e9c', 'u4ea1', 'u4ea4', 'u4ea8', 'u4eab',
         'u4eac', 'u4ead', 'u4eae', 'u4eba', 'u4ec1', 'u4ec7', 'u4eca', 'u4ecb', 'u4ecf', 'u4ed5', 'u4ed6', 'u4ed8',
         'u4ed9', 'u4ee3', 'u4ee4', 'u4ee5', 'u4eee', 'u4ef0', 'u4ef2', 'u4ef6', 'u4efb', 'u4f01', 'u4f0a', 'u4f0d',
         'u4f0f', 'u4f10', 'u4f11', 'u4f1a', 'u4f1d', 'u4f2f', 'u4f34', 'u4f38', 'u4f3a', 'u4f3c', 'u4f3d', 'u4f43',
         'u4f46', 'u4f4d', 'u4f4e', 'u4f4f', 'u4f50', 'u4f51', 'u4f53', 'u4f55', 'u4f59', 'u4f5c', 'u4f73', 'u4f75',
         'u4f7f', 'u4f8b', 'u4f8d', 'u4f9b', 'u4f9d', 'u4fa0', 'u4fa1', 'u4fae', 'u4faf', 'u4fb5', 'u4fbf', 'u4fc2',
         'u4fc3', 'u4fca', 'u4fd7', 'u4fdd', 'u4fe1', 'u4fe3', 'u4fee', 'u4ff3', 'u4ff5', 'u4ff8', 'u4ffa', 'u5009',
         'u500b', 'u500d', 'u5012', 'u5019', 'u501f', 'u5023', 'u5024', 'u502b', 'u502d', 'u5036', 'u5039', 'u5049',
         'u504f', 'u5055', 'u505c', 'u5065', 'u5072', 'u5074', 'u5075', 'u5076', 'u507d', 'u508d', 'u5091', 'u5098',
         'u5099', 'u50ac', 'u50b5', 'u50b7', 'u50be', 'u50cd', 'u50cf', 'u50d1', 'u50d5', 'u50da', 'u50e7', 'u5100',
         'u5104', 'u5112', 'u511f', 'u512a', 'u5132', 'u5141', 'u5143', 'u5144', 'u5145', 'u5146', 'u5148', 'u5149',
         'u514b', 'u514d', 'u5150', 'u515a', 'u515c', 'u5165', 'u5168', 'u516b', 'u516c', 'u516d', 'u5171', 'u5175',
         'u5176', 'u5177', 'u5178', 'u517c', 'u5185', 'u5186', 'u518a', 'u518d', 'u5192', 'u5197', 'u5199', 'u51a0',
         'u51a4', 'u51a5', 'u51a8', 'u51ac', 'u51b4', 'u51b7', 'u51c4', 'u51c6', 'u51cc', 'u51cd', 'u51dd', 'u51e1',
         'u51e6', 'u51e7', 'u51f1', 'u51f6', 'u51f8', 'u51f9', 'u51fa', 'u51fd', 'u5200', 'u5203', 'u5206', 'u5207',
         'u5208', 'u520a', 'u5211', 'u5217', 'u521d', 'u5224', 'u5225', 'u5229', 'u5230', 'u5236', 'u5237', 'u5238',
         'u523a', 'u523b', 'u5243', 'u5247', 'u524a', 'u524d', 'u5256', 'u525b', 'u5263', 'u5264', 'u5265', 'u526f',
         'u5270', 'u5272', 'u5275', 'u5287', 'u5289', 'u529b', 'u529f', 'u52a0', 'u52a3', 'u52a9', 'u52aa', 'u52b1',
         'u52b4', 'u52b9', 'u52be', 'u52c5', 'u52c7', 'u52c9', 'u52d5', 'u52d8', 'u52d9', 'u52dd', 'u52df', 'u52e2',
         'u52e4', 'u52e7', 'u52f2', 'u5302', 'u5305', 'u5316', 'u5317', 'u5320', 'u5321', 'u5339', 'u533a', 'u533b',
         'u533f', 'u5341', 'u5343', 'u5347', 'u5348', 'u534a', 'u5351', 'u5352', 'u5353', 'u5354', 'u5357', 'u5358',
         'u535a', 'u5360', 'u536f', 'u5370', 'u5371', 'u5373', 'u5374', 'u5375', 'u5378', 'u537f', 'u5384', 'u5398',
         'u539a', 'u539f', 'u53a6', 'u53a8', 'u53b3', 'u53bb', 'u53c2', 'u53c8', 'u53ca', 'u53cb', 'u53cc', 'u53cd',
         'u53ce', 'u53d4', 'u53d6', 'u53d7', 'u53d9', 'u53e2', 'u53e3', 'u53e4', 'u53e5', 'u53e9', 'u53ea', 'u53eb',
         'u53ec', 'u53ef', 'u53f0', 'u53f1', 'u53f2', 'u53f3', 'u53f6', 'u53f7', 'u53f8', 'u5404', 'u5408', 'u5409',
         'u540a', 'u540c', 'u540d', 'u540e', 'u5410', 'u5411', 'u541b', 'u541f', 'u5426', 'u542b', 'u5438', 'u5439',
         'u543e', 'u5442', 'u5446', 'u5448', 'u5449', 'u544a', 'u5451', 'u5468', 'u546a', 'u5473', 'u547c', 'u547d',
         'u548c', 'u54b2', 'u54b8', 'u54c0', 'u54c1', 'u54e1', 'u54e8', 'u54f2', 'u54fa', 'u5504', 'u5506', 'u5507',
         'u5510', 'u552f', 'u5531', 'u5544', 'u5546', 'u554f', 'u5553', 'u5584', 'u5589', 'u558b', 'u5598', 'u559a',
         'u559c', 'u559d', 'u55a7', 'u55aa', 'u55ab', 'u55ac', 'u55b6', 'u55c5', 'u55dc', 'u55e3', 'u5606', 'u5609',
         'u5618', 'u5631', 'u5642', 'u565b', 'u5668', 'u5674', 'u567a', 'u5687', 'u56c3', 'u56da', 'u56db', 'u56de',
         'u56e0', 'u56e3', 'u56f0', 'u56f2', 'u56f3', 'u56fa', 'u56fd', 'u570f', 'u5712', 'u571f', 'u5727', 'u5728',
         'u572d', 'u5730', 'u5742', 'u5747', 'u574a', 'u5750', 'u5751', 'u576a', 'u5782', 'u578b', 'u57a3', 'u57cb',
         'u57ce', 'u57df', 'u57f4', 'u57f7', 'u57f9', 'u57fa', 'u57fc', 'u5800', 'u5802', 'u5805', 'u5806', 'u5815',
         'u5824', 'u582a', 'u5830', 'u5831', 'u5834', 'u583a', 'u5840', 'u5841', 'u584a', 'u5854', 'u5857', 'u5859',
         'u585a', 'u5869', 'u587e', 'u5883', 'u5893', 'u5897', 'u589c', 'u58a8', 'u58b3', 'u58c1', 'u58c7', 'u58ca',
         'u58cc', 'u58d5', 'u58eb', 'u58ec', 'u58ee', 'u58f0', 'u58f1', 'u58f2', 'u58f7', 'u5909', 'u590f', 'u5915',
         'u5916', 'u591a', 'u591c', 'u5922', 'u5927', 'u5929', 'u592a', 'u592b', 'u592e', 'u5931', 'u5937', 'u5944',
         'u5947', 'u5948', 'u5949', 'u594f', 'u5951', 'u5954', 'u5965', 'u5968', 'u596a', 'u596e', 'u5973', 'u5974',
         'u597d', 'u5982', 'u5983', 'u5984', 'u598a', 'u5996', 'u5999', 'u59a5', 'u59a8', 'u59b9', 'u59bb', 'u59c9',
         'u59cb', 'u59d1', 'u59d3', 'u59d4', 'u59da', 'u59dc', 'u59eb', 'u59fb', 'u59ff', 'u5a01', 'u5a18', 'u5a20',
         'u5a2f', 'u5a3c', 'u5a46', 'u5a5a', 'u5a66', 'u5a7f', 'u5a92', 'u5a9b', 'u5ac1', 'u5ac9', 'u5acc', 'u5ae1',
         'u5b09', 'u5b22', 'u5b50', 'u5b54', 'u5b57', 'u5b58', 'u5b5c', 'u5b5d', 'u5b5f', 'u5b63', 'u5b64', 'u5b66',
         'u5b6b', 'u5b85', 'u5b87', 'u5b88', 'u5b89', 'u5b8b', 'u5b8c', 'u5b8d', 'u5b8f', 'u5b95', 'u5b97', 'u5b98',
         'u5b99', 'u5b9a', 'u5b9c', 'u5b9d', 'u5b9f', 'u5ba2', 'u5ba3', 'u5ba4', 'u5bae', 'u5bb0', 'u5bb3', 'u5bb4',
         'u5bb5', 'u5bb6', 'u5bb9', 'u5bbf', 'u5bc2', 'u5bc4', 'u5bc5', 'u5bc6', 'u5bcc', 'u5bd2', 'u5bd3', 'u5bdb',
         'u5bdd', 'u5bdf', 'u5be1', 'u5be7', 'u5be9', 'u5bee', 'u5bf8', 'u5bfa', 'u5bfe', 'u5bff', 'u5c01', 'u5c02',
         'u5c04', 'u5c06', 'u5c09', 'u5c0a', 'u5c0b', 'u5c0e', 'u5c0f', 'u5c11', 'u5c16', 'u5c1a', 'u5c2d', 'u5c31',
         'u5c39', 'u5c3a', 'u5c3b', 'u5c3c', 'u5c3d', 'u5c3e', 'u5c3f', 'u5c40', 'u5c45', 'u5c48', 'u5c4a', 'u5c4b',
         'u5c4f', 'u5c55', 'u5c5e', 'u5c64', 'u5c65', 'u5c6f', 'u5c71', 'u5c90', 'u5ca1', 'u5ca9', 'u5cac', 'u5cb3',
         'u5cb8', 'u5cd9', 'u5ce0', 'u5ce1', 'u5ce8', 'u5cef', 'u5cf0', 'u5cf6', 'u5cfb', 'u5d07', 'u5d0e', 'u5d14',
         'u5d29', 'u5d50', 'u5d6f', 'u5d8b', 'u5d8c', 'u5dba', 'u5dbd', 'u5dcc', 'u5ddd', 'u5dde', 'u5de1', 'u5de3',
         'u5de5', 'u5de6', 'u5de7', 'u5de8', 'u5dee', 'u5df1', 'u5df2', 'u5df3', 'u5df4', 'u5df7', 'u5dfb', 'u5dfd',
         'u5e02', 'u5e03', 'u5e06', 'u5e0c', 'u5e16', 'u5e1d', 'u5e25', 'u5e2b', 'u5e2d', 'u5e2f', 'u5e30', 'u5e33',
         'u5e38', 'u5e3d', 'u5e45', 'u5e4c', 'u5e55', 'u5e61', 'u5e63', 'u5e72', 'u5e73', 'u5e74', 'u5e78', 'u5e79',
         'u5e7b', 'u5e7c', 'u5e7d', 'u5e7e', 'u5e81', 'u5e83', 'u5e84', 'u5e8a', 'u5e8f', 'u5e95', 'u5e97', 'u5e9c',
         'u5ea6', 'u5ea7', 'u5eab', 'u5ead', 'u5eb5', 'u5eb6', 'u5eb7', 'u5eb8', 'u5ec3', 'u5ec9', 'u5eca', 'u5edf',
         'u5ee3', 'u5ef6', 'u5ef7', 'u5efa', 'u5f01', 'u5f0a', 'u5f0f', 'u5f13', 'u5f14', 'u5f15', 'u5f18', 'u5f1b',
         'u5f1f', 'u5f25', 'u5f26', 'u5f27', 'u5f31', 'u5f35', 'u5f37', 'u5f3e', 'u5f53', 'u5f57', 'u5f62', 'u5f66',
         'u5f69', 'u5f6a', 'u5f6b', 'u5f6c', 'u5f6d', 'u5f70', 'u5f71', 'u5f79', 'u5f7c', 'u5f80', 'u5f81', 'u5f84',
         'u5f85', 'u5f8b', 'u5f8c', 'u5f90', 'u5f92', 'u5f93', 'u5f97', 'u5f98', 'u5fa1', 'u5fa9', 'u5faa', 'u5fae',
         'u5fb3', 'u5fb4', 'u5fb9', 'u5fc3', 'u5fc5', 'u5fcc', 'u5fcd', 'u5fd7', 'u5fd8', 'u5fd9', 'u5fdc', 'u5fe0',
         'u5feb', 'u5ff5', 'u6012', 'u6016', 'u601c', 'u601d', 'u6020', 'u6025', 'u6027', 'u6028', 'u602a', 'u604b',
         'u6050', 'u6052', 'u6063', 'u6065', 'u6068', 'u6069', 'u606d', 'u606f', 'u6075', 'u608c', 'u6094', 'u609f',
         'u60a0', 'u60a3', 'u60a6', 'u60a9', 'u60aa', 'u60b2', 'u60bc', 'u60c5', 'u60c7', 'u60d1', 'u60da', 'u60dc',
         'u60df', 'u60e3', 'u60e7', 'u60e8', 'u60f0', 'u60f3', 'u6101', 'u6109', 'u610f', 'u611a', 'u611b', 'u611f',
         'u6148', 'u614b', 'u614c', 'u614e', 'u6155', 'u6162', 'u6163', 'u6167', 'u6168', 'u616e', 'u6170', 'u6176',
         'u6182', 'u618e', 'u61a4', 'u61a7', 'u61a9', 'u61b2', 'u61b6', 'u61be', 'u61c7', 'u61d0', 'u61f2', 'u61f8',
         'u6210', 'u6211', 'u6212', 'u6216', 'u6226', 'u622f', 'u6234', 'u6238', 'u623b', 'u623f', 'u6240', 'u6247',
         'u6249', 'u624b', 'u624d', 'u6253', 'u6255', 'u6271', 'u6276', 'u6279', 'u627f', 'u6280', 'u6284', 'u628a',
         'u6291', 'u6292', 'u6295', 'u6297', 'u6298', 'u629c', 'u629e', 'u62ab', 'u62b1', 'u62b5', 'u62b9', 'u62bc',
         'u62bd', 'u62c5', 'u62cd', 'u62d0', 'u62d2', 'u62d3', 'u62d8', 'u62d9', 'u62db', 'u62dd', 'u62e0', 'u62e1',
         'u62ec', 'u62ed', 'u62f3', 'u62f7', 'u62fe', 'u6301', 'u6307', 'u6311', 'u6319', 'u631f', 'u6328', 'u632b',
         'u632f', 'u633a', 'u633f', 'u6349', 'u6355', 'u635c', 'u6367', 'u6368', 'u636e', 'u6383', 'u6388', 'u638c',
         'u6392', 'u6398', 'u639b', 'u63a1', 'u63a2', 'u63a5', 'u63a7', 'u63a8', 'u63aa', 'u63b2', 'u63c3', 'u63cf',
         'u63d0', 'u63da', 'u63db', 'u63e1', 'u63ee', 'u63f4', 'u63fa', 'u640d', 'u641c', 'u642c', 'u642d', 'u643a',
         'u643e', 'u6442', 'u6458', 'u6469', 'u646f', 'u6483', 'u649a', 'u64a4', 'u64ab', 'u64ad', 'u64ae', 'u64b2',
         'u64c1', 'u64cd', 'u64e6', 'u64ec', 'u652f', 'u6539', 'u653b', 'u653e', 'u653f', 'u6545', 'u654f', 'u6551',
         'u6557', 'u6559', 'u6562', 'u6563', 'u6566', 'u656c', 'u6570', 'u6574', 'u6575', 'u6577', 'u6587', 'u6589',
         'u658e', 'u6590', 'u6591', 'u6597', 'u6599', 'u659c', 'u65a5', 'u65ac', 'u65ad', 'u65b0', 'u65b9', 'u65bc',
         'u65bd', 'u65c5', 'u65cb', 'u65cf', 'u65d7', 'u65db', 'u65e2', 'u65e5', 'u65e7', 'u65e8', 'u65e9', 'u65ec',
         'u65ed', 'u65fa', 'u6606', 'u6607', 'u660c', 'u660e', 'u6613', 'u6614', 'u661f', 'u6620', 'u6625', 'u6628',
         'u662d', 'u662f', 'u663c', 'u6642', 'u6643', 'u664b', 'u6669', 'u666e', 'u666f', 'u6674', 'u6676', 'u667a',
         'u6681', 'u6687', 'u6689', 'u6691', 'u6696', 'u6697', 'u66a2', 'u66a6', 'u66ab', 'u66ae', 'u66b4', 'u66c7',
         'u66d9', 'u66dc', 'u66f2', 'u66f4', 'u66f8', 'u66f9', 'u66fc', 'u66fd', 'u66ff', 'u6700', 'u6708', 'u6709',
         'u670b', 'u670d', 'u6714', 'u6717', 'u671b', 'u671d', 'u671f', 'u6728', 'u672a', 'u672b', 'u672c', 'u672d',
         'u6731', 'u6734', 'u673a', 'u673d', 'u6749', 'u674e', 'u674f', 'u6750', 'u6751', 'u6756', 'u675c', 'u675e',
         'u675f', 'u6761', 'u6765', 'u676d', 'u676f', 'u6771', 'u6775', 'u677e', 'u677f', 'u6790', 'u6795', 'u6797',
         'u679a', 'u679c', 'u679d', 'u67a0', 'u67a2', 'u67af', 'u67b6', 'u67c4', 'u67cf', 'u67d0', 'u67d3', 'u67d4',
         'u67da', 'u67f1', 'u67f3', 'u67f4', 'u67fb', 'u67ff', 'u6803', 'u6804', 'u6813', 'u6817', 'u6821', 'u682a',
         'u6838', 'u6839', 'u683c', 'u683d', 'u6842', 'u6843', 'u6848', 'u6850', 'u6851', 'u685c', 'u685d', 'u685f',
         'u6867', 'u6876', 'u6881', 'u6885', 'u6893', 'u68a8', 'u68af', 'u68b0', 'u68b6', 'u68c4', 'u68cb', 'u68d2',
         'u68da', 'u68df', 'u68ee', 'u68fa', 'u6905', 'u690d', 'u690e', 'u6919', 'u691c', 'u693f', 'u694a', 'u6955',
         'u6960', 'u6962', 'u696d', 'u6975', 'u697c', 'u697d', 'u6982', 'u698a', 'u698e', 'u699b', 'u69cb', 'u69cc',
         'u69cd', 'u69d8', 'u69d9', 'u69fb', 'u69fd', 'u6a0b', 'u6a19', 'u6a1f', 'u6a21', 'u6a29', 'u6a2a', 'u6a2b',
         'u6a39', 'u6a3a', 'u6a3d', 'u6a4b', 'u6a58', 'u6a5f', 'u6a7f', 'u6a80', 'u6a84', 'u6a9c', 'u6adb', 'u6b04',
         'u6b20', 'u6b21', 'u6b23', 'u6b27', 'u6b32', 'u6b3a', 'u6b3d', 'u6b3e', 'u6b4c', 'u6b53', 'u6b62', 'u6b63',
         'u6b64', 'u6b66', 'u6b69', 'u6b6a', 'u6b6f', 'u6b73', 'u6b74', 'u6b7b', 'u6b89', 'u6b8a', 'u6b8b', 'u6b96',
         'u6bb4', 'u6bb5', 'u6bba', 'u6bbb', 'u6bbf', 'u6bc5', 'u6bcd', 'u6bce', 'u6bd2', 'u6bd4', 'u6bdb', 'u6bec',
         'u6c0f', 'u6c11', 'u6c17', 'u6c34', 'u6c37', 'u6c38', 'u6c41', 'u6c42', 'u6c4e', 'u6c50', 'u6c57', 'u6c5a',
         'u6c5f', 'u6c60', 'u6c6a', 'u6c7a', 'u6c7d', 'u6c88', 'u6c96', 'u6c99', 'u6ca1', 'u6ca2', 'u6cb3', 'u6cb8',
         'u6cb9', 'u6cbb', 'u6cbc', 'u6cbf', 'u6cc1', 'u6cc9', 'u6cca', 'u6ccc', 'u6cd5', 'u6ce1', 'u6ce2', 'u6ce3',
         'u6ce5', 'u6ce8', 'u6cf0', 'u6cf3', 'u6d0b', 'u6d12', 'u6d17', 'u6d1b', 'u6d1e', 'u6d25', 'u6d2a', 'u6d32',
         'u6d38', 'u6d3b', 'u6d3e', 'u6d41', 'u6d44', 'u6d45', 'u6d59', 'u6d5c', 'u6d66', 'u6d69', 'u6d6a', 'u6d6e',
         'u6d74', 'u6d77', 'u6d78', 'u6d88', 'u6d99', 'u6daf', 'u6db2', 'u6dbc', 'u6dc0', 'u6dd1', 'u6dd8', 'u6de1',
         'u6df1', 'u6df3', 'u6df5', 'u6df7', 'u6dfb', 'u6e05', 'u6e07', 'u6e08', 'u6e09', 'u6e0b', 'u6e13', 'u6e15',
         'u6e1a', 'u6e1b', 'u6e21', 'u6e25', 'u6e26', 'u6e29', 'u6e2c', 'u6e2f', 'u6e4a', 'u6e56', 'u6e58', 'u6e5b',
         'u6e67', 'u6e6f', 'u6e7e', 'u6e7f', 'u6e80', 'u6e90', 'u6e96', 'u6e9c', 'u6e9d', 'u6ea2', 'u6ea5', 'u6eb6',
         'u6ec5', 'u6ecb', 'u6ed1', 'u6edd', 'u6ede', 'u6ef4', 'u6f01', 'u6f02', 'u6f06', 'u6f0f', 'u6f14', 'u6f15',
         'u6f20', 'u6f22', 'u6f2b', 'u6f2c', 'u6f31', 'u6f38', 'u6f54', 'u6f5c', 'u6f5f', 'u6f64', 'u6f6e', 'u6f84',
         'u6fa4', 'u6fc0', 'u6fc1', 'u6fc3', 'u6fe1', 'u6fef', 'u700b', 'u7015', 'u702c', 'u7058', 'u706b', 'u706f',
         'u7070', 'u707d', 'u7089', 'u708a', 'u708e', 'u7092', 'u70ad', 'u70b9', 'u70ba', 'u70c8', 'u70cf', 'u7109',
         'u7121', 'u7126', 'u7136', 'u713c', 'u714e', 'u7155', 'u7159', 'u7165', 'u7167', 'u7169', 'u716e', 'u718a',
         'u719f', 'u71b1', 'u71c3', 'u71c8', 'u71d5', 'u71e5', 'u7206', 'u722a', 'u7236', 'u723d', 'u7247', 'u7248',
         'u724c', 'u7259', 'u725b', 'u725d', 'u725f', 'u7261', 'u7262', 'u7267', 'u7269', 'u7272', 'u7279', 'u7280',
         'u72a0', 'u72ac', 'u72af', 'u72b6', 'u72c2', 'u72d0', 'u72d9', 'u72db', 'u72e9', 'u72ec', 'u72ed', 'u72f8',
         'u72fc', 'u731b', 'u731f', 'u732a', 'u732b', 'u732e', 'u7336', 'u7337', 'u733f', 'u7344', 'u7345', 'u7363',
         'u7372', 'u7384', 'u7387', 'u7389', 'u738b', 'u73a9', 'u73b2', 'u73c2', 'u73cd', 'u73e0', 'u73ed', 'u73fe',
         'u7403', 'u7406', 'u7409', 'u7422', 'u7434', 'u7435', 'u7436', 'u745b', 'u745e', 'u7460', 'u74b0', 'u74dc',
         'u74e6', 'u74f6', 'u7515', 'u7518', 'u751a', 'u751f', 'u7523', 'u7526', 'u7528', 'u752b', 'u7530', 'u7531',
         'u7532', 'u7533', 'u7537', 'u753a', 'u753b', 'u754c', 'u754f', 'u7551', 'u7554', 'u7559', 'u755c', 'u755d',
         'u7560', 'u7565', 'u756a', 'u7570', 'u7573', 'u757f', 'u758e', 'u7591', 'u75ab', 'u75b2', 'u75be', 'u75c5',
         'u75c7', 'u75d5', 'u75db', 'u75e2', 'u75f4', 'u7624', 'u7642', 'u764c', 'u7652', 'u7656', 'u767a', 'u767b',
         'u767d', 'u767e', 'u7684', 'u7686', 'u7687', 'u7690', 'u7693', 'u76ae', 'u76bf', 'u76c6', 'u76ca', 'u76d7',
         'u76db', 'u76df', 'u76e3', 'u76e4', 'u76e7', 'u76ee', 'u76f2', 'u76f4', 'u76f8', 'u76fe', 'u7701', 'u7709',
         'u770b', 'u770c', 'u771e', 'u771f', 'u7720', 'u773a', 'u773c', 'u7740', 'u7761', 'u7763', 'u7766', 'u7791',
         'u77ac', 'u77b3', 'u77db', 'u77e2', 'u77e5', 'u77e9', 'u77ed', 'u77ef', 'u77f3', 'u7802', 'u7814', 'u7815',
         'u7826', 'u7832', 'u7834', 'u785d', 'u786b', 'u786c', 'u786f', 'u7881', 'u7891', 'u7893', 'u78a7', 'u78ba',
         'u78c1', 'u78d0', 'u78e8', 'u78ef', 'u7901', 'u790e', 'u7912', 'u793a', 'u793c', 'u793e', 'u7947', 'u7948',
         'u7949', 'u7950', 'u7956', 'u795d', 'u795e', 'u7965', 'u7968', 'u796d', 'u7981', 'u7984', 'u7985', 'u798d',
         'u798e', 'u798f', 'u79c0', 'u79c1', 'u79cb', 'u79d1', 'u79d2', 'u79d8', 'u79df', 'u79e6', 'u79e9', 'u79f0',
         'u79fb', 'u7a00', 'u7a0b', 'u7a0e', 'u7a14', 'u7a1a', 'u7a1c', 'u7a2e', 'u7a32', 'u7a3c', 'u7a3d', 'u7a3f',
         'u7a40', 'u7a42', 'u7a4d', 'u7a4f', 'u7a63', 'u7a6b', 'u7a74', 'u7a76', 'u7a7a', 'u7a81', 'u7a83', 'u7a92',
         'u7a93', 'u7aaa', 'u7aae', 'u7aaf', 'u7acb', 'u7adc', 'u7ae0', 'u7ae5', 'u7aea', 'u7aef', 'u7af6', 'u7af9',
         'u7aff', 'u7b0f', 'u7b11', 'u7b18', 'u7b1b', 'u7b20', 'u7b26', 'u7b2c', 'u7b39', 'u7b46', 'u7b49', 'u7b4b',
         'u7b51', 'u7b52', 'u7b54', 'u7b56', 'u7b8f', 'u7b95', 'u7b97', 'u7ba1', 'u7bb1', 'u7bb8', 'u7bc0', 'u7bc4',
         'u7bc6', 'u7bc7', 'u7bc9', 'u7be0', 'u7be4', 'u7bed', 'u7c11', 'u7c17', 'u7c21', 'u7c3f', 'u7c4d', 'u7c73',
         'u7c89', 'u7c8b', 'u7c92', 'u7c95', 'u7c97', 'u7c98', 'u7c9b', 'u7c9f', 'u7ca5', 'u7ca7', 'u7cbe', 'u7cd6',
         'u7cde', 'u7ce7', 'u7cf8', 'u7cfb', 'u7cfe', 'u7d00', 'u7d04', 'u7d05', 'u7d0b', 'u7d0d', 'u7d14', 'u7d18',
         'u7d19', 'u7d1a', 'u7d1b', 'u7d20', 'u7d21', 'u7d22', 'u7d2b', 'u7d2f', 'u7d30', 'u7d33', 'u7d39', 'u7d3a',
         'u7d42', 'u7d44', 'u7d46', 'u7d4c', 'u7d50', 'u7d5e', 'u7d61', 'u7d62', 'u7d66', 'u7d71', 'u7d75', 'u7d76',
         'u7d79', 'u7d99', 'u7d9a', 'u7d9c', 'u7dad', 'u7db1', 'u7db2', 'u7db4', 'u7dba', 'u7dbe', 'u7dbf', 'u7dca',
         'u7dcb', 'u7dcf', 'u7dd1', 'u7dd2', 'u7dda', 'u7de0', 'u7de8', 'u7de9', 'u7def', 'u7df4', 'u7dfb', 'u7e01',
         'u7e04', 'u7e1b', 'u7e1e', 'u7e26', 'u7e2b', 'u7e2e', 'u7e3e', 'u7e41', 'u7e4a', 'u7e54', 'u7e55', 'u7e6d',
         'u7e70', 'u7f36', 'u7f6a', 'u7f6e', 'u7f70', 'u7f72', 'u7f75', 'u7f77', 'u7f85', 'u7f8a', 'u7f8e', 'u7fa4',
         'u7fa9', 'u7fbd', 'u7fc1', 'u7fcc', 'u7fd2', 'u7fd4', 'u7fe0', 'u7feb', 'u7ffb', 'u7ffc', 'u8000', 'u8001',
         'u8003', 'u8005', 'u8010', 'u8015', 'u8033', 'u8056', 'u805e', 'u8061', 'u806f', 'u8074', 'u8077', 'u8087',
         'u8089', 'u808c', 'u8096', 'u809d', 'u80a1', 'u80a2', 'u80a5', 'u80a9', 'u80aa', 'u80af', 'u80b2', 'u80ba',
         'u80c3', 'u80c6', 'u80cc', 'u80ce', 'u80da', 'u80de', 'u80e1', 'u80f4', 'u80f8', 'u80fd', 'u8102', 'u8105',
         'u8107', 'u8108', 'u810a', 'u811a', 'u8129', 'u8131', 'u8133', 'u814e', 'u8150', 'u8155', 'u816b', 'u8170',
         'u8178', 'u8179', 'u819a', 'u819c', 'u819d', 'u81a0', 'u81a8', 'u81b3', 'u81d3', 'u81e3', 'u81e8', 'u81ea',
         'u81ed', 'u81f3', 'u81f4', 'u81fc', 'u8208', 'u820c', 'u820e', 'u8217', 'u8218', 'u821b', 'u821c', 'u821e',
         'u821f', 'u8229', 'u822a', 'u822c', 'u8235', 'u8236', 'u8239', 'u8247', 'u8266', 'u826f', 'u8272', 'u8276',
         'u828b', 'u8299', 'u829d', 'u82a5', 'u82a6', 'u82ad', 'u82af', 'u82b1', 'u82b3', 'u82b8', 'u82b9', 'u82bd',
         'u82c5', 'u82d1', 'u82d7', 'u82e5', 'u82e6', 'u82eb', 'u82f1', 'u8302', 'u8305', 'u830e', 'u8317', 'u831c',
         'u8328', 'u8336', 'u8349', 'u834f', 'u8352', 'u8358', 'u8377', 'u837b', 'u83c5', 'u83ca', 'u83cc', 'u83d3',
         'u83dc', 'u83e9', 'u83ef', 'u83f1', 'u840c', 'u8429', 'u842c', 'u8431', 'u843d', 'u8449', 'u8457', 'u845b',
         'u8466', 'u846c', 'u8475', 'u848b', 'u8494', 'u8499', 'u84b2', 'u84b8', 'u84bc', 'u84c4', 'u84cb', 'u84ee',
         'u84fc', 'u8511', 'u8521', 'u8526', 'u852d', 'u8535', 'u8543', 'u8549', 'u8568', 'u8584', 'u8594', 'u85a6',
         'u85a9', 'u85aa', 'u85ab', 'u85ac', 'u85ae', 'u85c1', 'u85cd', 'u85cf', 'u85dd', 'u85e4', 'u85e9', 'u85fb',
         'u8607', 'u862d', 'u864e', 'u8650', 'u865a', 'u865c', 'u866b', 'u8679', 'u868a', 'u8695', 'u86c7', 'u86cb',
         'u86cd', 'u86ed', 'u86ee', 'u8702', 'u871c', 'u8737', 'u8776', 'u878d', 'u87f9', 'u8840', 'u8846', 'u884c',
         'u8853', 'u8857', 'u885b', 'u885d', 'u8861', 'u8863', 'u8868', 'u8870', 'u8877', 'u8881', 'u888b', 'u8896',
         'u88ab', 'u88b4', 'u88c1', 'u88c2', 'u88c5', 'u88cf', 'u88d5', 'u88dc', 'u88f8', 'u88fd', 'u88fe', 'u8907',
         'u8910', 'u8912', 'u8944', 'u895f', 'u8972', 'u897f', 'u8981', 'u8986', 'u8987', 'u898b', 'u898f', 'u8996',
         'u899a', 'u89a7', 'u89aa', 'u89b3', 'u89d2', 'u89e3', 'u89e6', 'u8a00', 'u8a02', 'u8a03', 'u8a08', 'u8a0e',
         'u8a13', 'u8a17', 'u8a18', 'u8a1f', 'u8a2a', 'u8a2d', 'u8a31', 'u8a33', 'u8a34', 'u8a3a', 'u8a3c', 'u8a50',
         'u8a54', 'u8a55', 'u8a5e', 'u8a60', 'u8a66', 'u8a69', 'u8a6b', 'u8a70', 'u8a71', 'u8a72', 'u8a73', 'u8a87',
         'u8a89', 'u8a8c', 'u8a8d', 'u8a93', 'u8a95', 'u8a98', 'u8a9e', 'u8aa0', 'u8aa4', 'u8aac', 'u8aad', 'u8ab0',
         'u8ab2', 'u8abf', 'u8ac7', 'u8acb', 'u8acc', 'u8acf', 'u8ad6', 'u8adc', 'u8ae6', 'u8aed', 'u8aee', 'u8af8',
         'u8afe', 'u8b00', 'u8b04', 'u8b0e', 'u8b19', 'u8b1b', 'u8b1d', 'u8b21', 'u8b33', 'u8b39', 'u8b58', 'u8b5c',
         'u8b66', 'u8b70', 'u8b72', 'u8b77', 'u8b83', 'u8c37', 'u8c46', 'u8c4a', 'u8c5a', 'u8c61', 'u8c6a', 'u8c9d',
         'u8c9e', 'u8ca0', 'u8ca1', 'u8ca2', 'u8ca7', 'u8ca8', 'u8ca9', 'u8cab', 'u8cac', 'u8caf', 'u8cb0', 'u8cb4',
         'u8cb7', 'u8cb8', 'u8cbb', 'u8cbc', 'u8cbf', 'u8cc0', 'u8cc3', 'u8cc4', 'u8cc7', 'u8cca', 'u8cd3', 'u8cdb',
         'u8cdc', 'u8cde', 'u8ce0', 'u8ce2', 'u8cea', 'u8ced', 'u8cfc', 'u8d05', 'u8d08', 'u8d0b', 'u8d64', 'u8d66',
         'u8d70', 'u8d73', 'u8d74', 'u8d77', 'u8d85', 'u8d8a', 'u8d99', 'u8da3', 'u8db3', 'u8ddd', 'u8de1', 'u8def',
         'u8df3', 'u8df5', 'u8e0a', 'u8e0f', 'u8e44', 'u8e74', 'u8e8d', 'u8eab', 'u8eca', 'u8ecc', 'u8ecd', 'u8ed2',
         'u8edf', 'u8ee2', 'u8ef8', 'u8efd', 'u8f03', 'u8f09', 'u8f14', 'u8f1d', 'u8f29', 'u8f2a', 'u8f38', 'u8f44',
         'u8f4d', 'u8f5f', 'u8f9b', 'u8f9e', 'u8fb0', 'u8fb1', 'u8fb2', 'u8fba', 'u8fbb', 'u8fbc', 'u8fc5', 'u8fce',
         'u8fd1', 'u8fd4', 'u8fe6', 'u8feb', 'u8fed', 'u8ff0', 'u8ff7', 'u8ffd', 'u9000', 'u9001', 'u9003', 'u9006',
         'u900f', 'u9010', 'u9013', 'u9014', 'u9017', 'u901a', 'u901d', 'u901f', 'u9020', 'u9022', 'u9023', 'u902e',
         'u9031', 'u9032', 'u9038', 'u9042', 'u9045', 'u9047', 'u904a', 'u904b', 'u904d', 'u904e', 'u9053', 'u9054',
         'u9055', 'u9060', 'u9063', 'u9065', 'u9069', 'u906d', 'u906e', 'u9077', 'u9078', 'u907a', 'u907c', 'u907f',
         'u9084', 'u9091', 'u90a3', 'u90a6', 'u90aa', 'u90b8', 'u90c1', 'u90ca', 'u90ce', 'u90e1', 'u90e8', 'u90ed',
         'u90f5', 'u90f7', 'u90fd', 'u9112', 'u912d', 'u9149', 'u914c', 'u914d', 'u9152', 'u9154', 'u9162', 'u916a',
         'u916c', 'u9175', 'u9177', 'u9178', 'u918d', 'u919c', 'u91a4', 'u91b8', 'u91c8', 'u91cc', 'u91cd', 'u91ce',
         'u91cf', 'u91d1', 'u91d8', 'u91dc', 'u91dd', 'u91e3', 'u91e7', 'u920d', 'u9234', 'u9244', 'u925b', 'u9262',
         'u9271', 'u927e', 'u9280', 'u9283', 'u9285', 'u9295', 'u9298', 'u929a', 'u92ad', 'u92ed', 'u92f3', 'u92fc',
         'u9320', 'u9326', 'u932b', 'u932c', 'u932f', 'u9332', 'u934b', 'u935b', 'u9375', 'u937c', 'u937e', 'u938c',
         'u9396', 'u93ae', 'u93e1', 'u9418', 'u9451', 'u9577', 'u9580', 'u9589', 'u958b', 'u9591', 'u9593', 'u95a2',
         'u95a3', 'u95a5', 'u95b2', 'u95c7', 'u95ca', 'u95d8', 'u961c', 'u962a', 'u9632', 'u963b', 'u963f', 'u9644',
         'u964d', 'u9650', 'u965b', 'u9662', 'u9663', 'u9664', 'u9665', 'u966a', 'u9670', 'u9673', 'u9675', 'u9676',
         'u9678', 'u967a', 'u967d', 'u9685', 'u9686', 'u9688', 'u968a', 'u968e', 'u968f', 'u9694', 'u969b', 'u969c',
         'u96a0', 'u96a3', 'u96b7', 'u96bb', 'u96bc', 'u96c0', 'u96c1', 'u96c4', 'u96c5', 'u96c6', 'u96c7', 'u96cc',
         'u96d1', 'u96db', 'u96e2', 'u96e3', 'u96e8', 'u96ea', 'u96eb', 'u96f0', 'u96f2', 'u96f6', 'u96f7', 'u96fb',
         'u9700', 'u9707', 'u970a', 'u971c', 'u971e', 'u9727', 'u9732', 'u9752', 'u9756', 'u9759', 'u975e', 'u9762',
         'u9769', 'u9774', 'u978d', 'u97d3', 'u97ee', 'u97f3', 'u97fb', 'u97ff', 'u9802', 'u9803', 'u9805', 'u9806',
         'u9808', 'u9810', 'u9811', 'u9812', 'u9818', 'u981a', 'u982c', 'u982d', 'u983b', 'u983c', 'u984c', 'u984d',
         'u9854', 'u9855', 'u9858', 'u985e', 'u9867', 'u98a8', 'u98db', 'u98df', 'u98e2', 'u98ef', 'u98f2', 'u98fc',
         'u98fd', 'u98fe', 'u9905', 'u990a', 'u990c', 'u9913', 'u9928', 'u9957', 'u9996', 'u9999', 'u99a8', 'u99ac',
         'u99c4', 'u99c5', 'u99c6', 'u99d0', 'u99d2', 'u99ff', 'u9a0e', 'u9a12', 'u9a13', 'u9a30', 'u9a5a', 'u9aa8',
         'u9ac4', 'u9ad8', 'u9aea', 'u9b3c', 'u9b41', 'u9b42', 'u9b45', 'u9b4f', 'u9b54', 'u9b5a', 'u9b6f', 'u9b8e',
         'u9bab', 'u9bad', 'u9bae', 'u9bc9', 'u9bdb', 'u9be8', 'u9c52', 'u9c57', 'u9ce5', 'u9ce9', 'u9cf3', 'u9cf4',
         'u9d08', 'u9d0e', 'u9d28', 'u9d3b', 'u9d5c', 'u9d60', 'u9d6c', 'u9d8f', 'u9db4', 'u9df2', 'u9df9', 'u9dfa',
         'u9e7f', 'u9e93', 'u9e97', 'u9ea6', 'u9eb9', 'u9eba', 'u9ebb', 'u9ec4', 'u9ece', 'u9ed2', 'u9ed9', 'u9edb',
         'u9f13', 'u9f3b', 'u9f62', 'u9f8d']

print(image_tensor.shape)

interpreter = tf.lite.Interpreter(model_path="output.tflite")
interpreter.allocate_tensors()

input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

input_shape = input_details[0]['shape']


interpreter.set_tensor(input_details[0]['index'], image_tensor)

interpreter.invoke()

output_data = interpreter.get_tensor(output_details[0]['index'])

ax = plt.subplot(3, 3, 8)
plt.imshow(np.array(drawn))
plt.title("input")
for i in range(6):
    ax = plt.subplot(3, 3, i + 1)
    index = np.argsort(output_data)[0][len(output_data[0]) - 1 - i]
    print("index: " + str(index) + ", confidence: " + str(output_data[0][index]) + ". unicode = " + names[index])
    plt.imshow(np.array(Image.open(DATASET_PATH + names[index] + "/0.png")))
    plt.title(str(i + 1))
    plt.axis("off")
plt.show()
